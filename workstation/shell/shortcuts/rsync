#!/bin/sh

shopt -s dotglob

SOURCE_PATH="/Volumes/DroboMax 2 1/Old-Backups.backupdb/Blurb-GCowley/"
DEST_PATH=/Volumes/gPhoto2tb/TMFlattened
DONE="2016-06-06-005627 2016-06-13-000322 2016-06-20-095151 2016-07-02-004214 2016-07-10-085831 2016-07-18-173024 2016-07-31-212734 2016-08-07-112429 2016-08-15-153700 2016-08-26-185430 2016-09-09-114118 2016-09-20-080653 2016-09-27-015018 2016-10-14-131739 2016-10-21-094149"

cd "$SOURCE_PATH" || exit


syncit ( ) {
  # echo "$1 is a directory"
  FOUND=false

  for folder in $DONE ; do
    # echo "$folder"
    if [ "$folder/" = "$1" ]; then
      echo "Already done $1"
      FOUND=true
    fi
  done
  if [ "$FOUND" != true ]; then
    echo "Synching folder $1"
    rsync -rai -P --stats --ignore-existing --exclude "Dropbox (Blurb)/" "$SOURCE_PATH$1Macintosh HD/Users" "$DEST_PATH"
  fi
}

# 2016-06-06-005627
# 2016-06-13-000322
# 2016-06-20-095151
# 2016-07-02-004214
# 2016-07-10-085831
# 2016-07-18-173024
# 2016-07-31-212734
# 2016-08-07-112429
# 2016-08-15-153700
# 2016-08-26-185430
# 2016-09-09-114118
# 2016-09-20-080653
# 2016-09-27-015018
# 2016-10-14-131739
# 2016-10-21-094149
# syncit "2016-10-28-091049/"
# syncit "2016-11-06-144254/"
# syncit "2016-11-14-155404/"
# syncit "2016-12-24-005522/"
syncit "2016-12-31-161741/"
# 2017-01-15-201006
# 2017-01-24-102113
# 2017-02-04-120745
# 2017-02-07-075838
# 2017-02-18-010049
# 2017-02-18-021101
# 2017-02-18-032123
# 2017-02-18-042705
# 2017-02-18-052917
# 2017-02-18-063043
# 2017-02-18-073158

# for file in */; do syncit $file; done
